# Code

This directory contains code for all models and analyses. 

## Setup
```
conda create -n rsm python=3.12 -y
conda activate rsm
pip install -r requirements.txt

cd code/simulation_model
```

## Recursive simulation model
The recursive simulation model is implemented in the `simulation_model` directory. 

### Other models
There are a few variants of the RSM that are included in the `simulation_model` directory: 

**Uniform simulation**: Samples paths uniformly, and hence does not distinguish between naive and sophisticated agents.

**Empirical**: Uses the paths generated by participants in place of simulated paths. Also includes a `mismatched` version, where the naive detective uses sophisticated participant paths and vice versa. 

Note that the `analysis` directory contains code for other models included in the paper, including the heuristic model and GPT-4o.

## Usage

Run the simulation model with the following command:
```bash
python main.py simulate \
    --trial <trial_name> \
    --w <cost_fn_weight> \
    --n-temp <naive_softmax_temp> \
    --s-temp <soph_softmax_temp> \
    --max-steps <max_steps> \
    --log-dir <log_dir>
```

Examples:
```bash
# RSM
python main.py simulate --trial 'snack1' --w 0.5 

# Uniform
python main.py uniform --trial 'snack6' --max-steps 25

# Empirical
python main.py empirical --trial 'snack1' --w 0.3

# Empirical (mismatched)
python main.py empirical --trial 'snack1' --w 0.3 --mismatched
```

### Command line arguments

| Argument | Commands | Type | Default | Description |
|----------|----------|------|---------|-------------|
| `--trial` | `simulate`, `empirical`, `uniform`  | `str`  | `'snack1'` | Trial name
| `--w` | `simulate` | `float` | `0.1` | Weight parameter for the cost function
| `--n-temp` | `simulate` | `float` | `0.01` | Softmax temperature for the naive agent
| `--s-temp` | `simulate` | `float` | `0.01` | Softmax temperature for the sophisticated agent
| `--max-steps` | `simulate`, `uniform` | `int` | `25` | Maximum number of steps for subgoal simple paths
| `--log-dir` | `simulate`, `empirical`, `uniform` | `str` | `'../../results'` | Data logging directory for the model
| `--paths` | `empirical` | `str` | `'../../data/exp1_suspect/humans/human_paths.csv'` | Path to CSV with empirical paths
| `--mismatched` | `empirical` | `flag` | `False` | Swap naive and sophisticated paths
